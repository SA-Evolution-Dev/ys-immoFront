<nav class="mb-3" aria-label="breadcrumb">
    <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
        <li class="breadcrumb-item"><a href="javascript:void(0)">Nouvelle annonce</a></li>
    </ol>
</nav>

<h2 class="mb-4">Nouvelle annonce</h2>
<div class="row">
    <div class="col-xl-9">
        <form [formGroup]="bienForm" (ngSubmit)="onSubmitForm()" class="row g-2 mb-6">
            <div class="col-sm-6 col-md-8">
                <div class="form-floating">
                    <input id="title" type="text" 
                        formControlName="title" placeholder="Donner un titre ici" 
                        class="form-control" [class.is-invalid]="isFieldInvalid('title')" />
                    <label for="title">Titre de l'annonce *</label>
                </div>
                @if (isFieldInvalid('title')) {
                    <span class="error-message">Veuillez saisir le titre de l'annonce</span>
                }
            </div>

            <!-- STATUT -->
            <div class="col-sm-6 col-md-4">
                <div class="form-floating">
                    <select id="statut" formControlName="statut" class="form-select"
                        class="form-control" [class.is-invalid]="isFieldInvalid('statut')">
                        <option value="brouillon">Mettre au brouillon</option>
                        <option value="actif">Mettre en publication</option>
                    </select>
                    <label for="statut">Statut</label>
                </div>
                @if (isFieldInvalid('statut')) {
                    <span class="error-message">Veuillez sélectionner le statut</span>
                }
            </div>

            <!-- TYPE DE BIEN -->
            <div class="col-md-12">
                <div class="form-floating">
                    <select id="type" formControlName="type"
                        class="form-select" [class.is-invalid]="isFieldInvalid('type')">
                        <option value="">-- Sélectionnez --</option>
                        <option value="appartement">Appartement</option>
                        <option value="villa">Villa</option>
                        <option value="studio">Studio</option>
                        <option value="bureau">Bureau</option>
                    </select>
                    <label for="type">Type de bien *</label>
                </div>
                @if (isFieldInvalid('type')) {
                    <span class="error-message">Veuillez sélectionner le type d'annonce</span>
                }
            </div>

            <!-- DESCRIPTION -->
            <div class="col-12">
                <div>
                    <app-rich-text-editor formControlName="description" [height]="200" 
                        [placeholder]="'Entrez votre description...'"
                        [toolbar]="'bold italic | underline  | blocks  | forecolor | backcolor | alignleft | alignright | numlist | bullist'"
                        [plugins]="['lists']"
                    ></app-rich-text-editor>
                </div>
                @if (isFieldInvalid('description')) {
                    <span class="error-message">Veuillez saisir la description</span>
                }
            </div>

            <!-- CONTACT GROUP -->
            <div class="col-12">
                <h4 class="mt-3 mb-2">
                    <i class="fas fa-phone text-info"></i>
                    Informations personnelles
                </h4>
                <div class="row g-2" formGroupName="contact">
                    <div class="col-md-4">
                        <div class="form-floating">
                            <input id="contactNom" type="text" 
                                formControlName="nom" placeholder="Nom" class="form-control"
                                [class.is-invalid]="isFieldInvalid('contact.nom')" />
                            <label for="contactNom">Nom du contact *</label>
                        </div>
                        @if (isFieldInvalid('contact.nom')) {
                            <span class="error-message">Veuillez saisir votre nom</span>
                        }
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input id="contactTelephone" type="tel" 
                                formControlName="telephone" placeholder="+225 XX XX XX XX" class="form-control"
                                [class.is-invalid]="isFieldInvalid('contact.telephone')" />
                            <label for="contactTelephone">Téléphone *</label>
                        </div>
                        @if (isFieldInvalid('contact.telephone')) {
                            <span class="error-message">Veuillez saisir la Téléphone</span>
                        }
                    </div>

                    <div class="col-md-4">
                        <div class="form-floating">
                            <input id="contactEmail" type="email" 
                                formControlName="email" placeholder="email@exemple.com" class="form-control"
                                [class.is-invalid]="isFieldInvalid('contact.email')" />
                            <label for="contactEmail">Email </label>
                        </div>
                        @if (isFieldInvalid('contact.email')) {
                            <span class="error-message">Veuillez saisir la Téléphone</span>
                        }
                    </div>
                </div>
            </div>

            <!-- LOCALISATION GROUP -->
            <div class="col-12">
                <h4 class="mt-3 mb-2">
                    <i class="fas fa-location text-info"></i>
                    Votre bien est situé dans ?
                </h4>
                <div class="row g-2" formGroupName="localisation">
                    <div class="col-md-6">
                        <app-search-select
                            [class.is-invalid]="isFieldInvalid('localisation.ville')"
                            id="ville" label="Ville" formControlName="ville"
                            [options]="liste_villes" [required]="true"
                        />
                        @if (isFieldInvalid('localisation.ville')) {
                            <span class="error-message">Veuillez sélectionner la ville</span>
                        }
                    </div>

                    <div class="col-md-6">
                        <app-search-select
                            [class.is-invalid]="isFieldInvalid('localisation.commune')"
                            id="commune" label="Commune" formControlName="commune"
                            [options]="actual_communes()" [required]="true" [disabled]="actual_communes().length === 0"
                            [placeholder]="actual_communes().length === 0 ? '-- Aucune commune disponible --' : '-- Sélectionnez --'"
                        />
                        @if (isFieldInvalid('localisation.commune')) {
                            <span class="error-message">Veuillez sélectionner la commune</span>
                        }
                        <!-- @if (actual_communes().length === 0 && bienForm.get('localisation.ville')?.value) {
                            <small class="text-muted d-block mt-1">
                                <i class="fas fa-info-circle"></i> Aucune commune disponible pour cette ville
                            </small>
                        } -->
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input id="llongitude" type="number" 
                                formControlName="longitude" placeholder="longitude" class="form-control"
                                [class.is-invalid]="isFieldInvalid('localisation.longitude')" />
                            <label for="llongitude">Longitude </label>
                        </div>
                        @if (isFieldInvalid('localisation.longitude')) {
                            <span class="error-message">Veuillez saisir la longitude</span>
                        }
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input id="llatitude" type="number" 
                                formControlName="latitude" placeholder="latitude" class="form-control"
                                [class.is-invalid]="isFieldInvalid('localisation.latitude')" />
                            <label for="llatitude">Latitude </label>
                        </div>
                        @if (isFieldInvalid('localisation.latitude')) {
                            <span class="error-message">Veuillez saisir la latitude</span>
                        }
                    </div>
                </div>
            </div>

            <!-- COMPOSITION GROUP -->
            <div class="col-12">
                <h4 class="mt-3 mb-2">
                    <i class="fas fa-location text-info"></i>
                    Composition du bien
                </h4>
                <div class="row g-2" formGroupName="composition">
                    <div class="col-md-6">
                        <div class="form-floating">
                            <input id="lnombreChambres" type="number" 
                                formControlName="nombreChambres" placeholder="" class="form-control"
                                [class.is-invalid]="isFieldInvalid('composition.nombreChambres')" />
                            <label for="lnombreChambres">Nombre de chambres </label>
                        </div>
                        @if (getFieldError('composition.nombreChambres', 'min')) {
                            <span class="error-message">La valeur saisie est incorrecte</span>
                        }
                        @else if (isFieldInvalid('composition.nombreChambres')) {
                            <span class="error-message">Veuillez saisir une valeur</span>
                        }
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input id="lnombreSalons" type="number" 
                                formControlName="nombreSalons" placeholder="" class="form-control"
                                [class.is-invalid]="isFieldInvalid('composition.nombreSalons')" />
                            <label for="lnombreSalons">Nombre de salons </label>
                        </div>
                        @if (getFieldError('composition.nombreSalons', 'min')) {
                            <span class="error-message">La valeur saisie est incorrecte</span>
                        }
                        @else if (isFieldInvalid('composition.nombreSalons')) {
                            <span class="error-message">Veuillez saisir une valeur</span>
                        }
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input id="lnombreSallesBain" type="number" 
                                formControlName="nombreSallesBain" placeholder="" class="form-control"
                                [class.is-invalid]="isFieldInvalid('composition.nombreSallesBain')" />
                            <label for="lnombreSallesBain">Nombre de douche </label>
                        </div>
                        @if (getFieldError('composition.nombreSallesBain', 'min')) {
                            <span class="error-message">La valeur saisie est incorrecte</span>
                        }
                        @else if (isFieldInvalid('composition.nombreSallesBain')) {
                            <span class="error-message">Veuillez saisir une valeur</span>
                        }
                    </div>

                    <div class="col-md-6">
                        <div class="form-floating">
                            <input id="lnombreCuisine" type="number" 
                                formControlName="nombreCuisine" placeholder="" class="form-control"
                                [class.is-invalid]="isFieldInvalid('composition.nombreCuisine')" />
                            <label for="lnombreCuisine">Nombre de cuisine </label>
                        </div>
                        @if (getFieldError('composition.nombreCuisine', 'min')) {
                            <span class="error-message">La valeur saisie est incorrecte</span>
                        }
                        @else if (isFieldInvalid('composition.nombreCuisine')) {
                            <span class="error-message">Veuillez saisir une valeur</span>
                        }
                    </div>

                    <div class="col-md-12">
                        <div class="form-floating">
                            <select id="toilettesVisiteurs" formControlName="toilettesVisiteurs" class="form-select" 
                                [class.is-invalid]="isFieldInvalid('composition.toilettesVisiteurs')">
                                <option [value]="null">-- Sélectionnez --</option>
                                <option [value]="false">Non</option>
                                <option [value]="true">Oui</option>
                            </select>
                            <label for="douche">Est ce quil possede une douche visiteur ?</label>
                        </div>
                        @if (isFieldInvalid('composition.toilettesVisiteurs')) {
                            <span class="error-message">Veuillez sélectionner si ya toulette visiteur</span>
                        }
                    </div>
                </div>
            </div>

            
            <div class="accordion" id="accordionExample">
                <div class="accordion-item border-top">
                    <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                        Ajouter des inforùations sur l'equipeùent interieurs
                    </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapseOne" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body pt-0">
                            <!-- EQUIPMENTS INTERIEURS GROUP -->
                            <div class="col-12">
                                <h4 class="mt-3 mb-2">
                                    <i class="fas fa-location text-info"></i>
                                    Vos equipements interieurs
                                </h4>
                                <div class="row g-2" formGroupName="equipementsInterieurs">
                                
                                    <div class="mb-3">
                                        <!-- formControlName="tags" -->
                                        <app-multi-select
                                            id="tags"
                                            label="Ajouter des tags"
                                            placeholder="Choisir des tags..."
                                            [options]="tagOptions"
                                            [removeItemButton]="true"
                                            [searchable]="true"
                                            [isInvalid]="isFieldInvalid('tags')"
                                        >
                                            <span error-message>
                                            <i class="fas fa-exclamation-circle me-1"></i>
                                            Veuillez sélectionner au moins un tag
                                            </span>
                                        </app-multi-select>
                                    </div>

                                    <!-- <div class="col-md-6">
                                        <div class="form-floating">
                                            <input id="lnombreChambres" type="number" formControlName="nombreChambres" placeholder=""
                                                class="form-control" [class.is-invalid]="isFieldInvalid('equipementsInterieurs.nombreChambres')" />
                                            <label for="lnombreChambres">Nombre de chambres </label>
                                        </div>
                                        @if (getFieldError('equipementsInterieurs.nombreChambres', 'min')) {
                                        <span class="error-message">La valeur saisie est incorrecte</span>
                                        }
                                        @else if (isFieldInvalid('equipementsInterieurs.nombreChambres')) {
                                        <span class="error-message">Veuillez saisir une valeur</span>
                                        }
                                    </div> -->
                                </div>
                            </div>








                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">

                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        How long does it take to ship my order?

                    </button>
                    </h2>
                    <div class="accordion-collapse collapse" id="collapseTwo" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                    <div class="accordion-body pt-0">
                        <strong>This is the second item's accordion body.</strong>
                        It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
                    </div>
                    </div>
                </div>
            </div>
                    


            















            <div class="col-sm-6 col-md-4">
                <div class="form-floating">
                    <select class="form-select" id="statut">
                        <option selected="selected">Select task view</option>
                        <option value="1">technical</option>
                        <option value="2">external</option>
                        <option value="3">organizational</option>
                    </select>
                    <label for="statut">Statut</label>
                </div>
            </div>

            


            <div class="col-sm-6 col-md-4">
                <div class="form-floating">
                    <select class="form-select" id="floatingSelectAdmin">
                        <option selected="selected">Select admin</option>
                        <option value="1">Data Privacy One</option>
                        <option value="2">Data Privacy Two</option>
                        <option value="3">Data Privacy Three</option>
                    </select>
                    <label for="floatingSelectAdmin">Project Lead</label>
                </div>
            </div>

            <div class="col-sm-6 col-md-4">
                <div class="flatpickr-input-container">
                    <div class="form-floating">
                        <input class="form-control datetimepicker" id="floatingInputStartDate" type="text"
                            placeholder="end date" data-options='{"disableMobile":true}' />
                        <label class="ps-6" for="floatingInputStartDate">Start date</label><span
                            class="uil uil-calendar-alt flatpickr-icon text-body-tertiary"></span>
                    </div>
                </div>
            </div>


            <div class="col-12 mt-2">
                <app-rich-text-editor
                    formControlName="description"
                    [height]="200"
                    [placeholder]="'Entrez une description...'"
                    [toolbar]="'bold italic | underline  | blocks  | forecolor | backcolor | alignleft | alignright | numlist | bullist'"
                    [plugins]="['lists']"
                ></app-rich-text-editor>
            </div>



            <div class="form-group">
                <label>Date simple</label>
                <input
                    type="text"
                    class="form-control"
                    appFlatpickr
                    [config]="dateConfig"
                    (dateChange)="onDateChange($event)"
                    placeholder="Sélectionner une date"
                >
            </div>

            <div class="form-group">
            <label>Date et heure</label>
            <input
                type="text"
                class="form-control"
                appFlatpickr
                [config]="dateTimeConfig"
                (dateChange)="onDateTimeChange($event)"
                placeholder="Date et heure"
            >
            </div>

            <div class="form-group">
            <label>Plage de dates</label>
            <input
                type="text"
                class="form-control"
                appFlatpickr
                [config]="rangeConfig"
                (dateChange)="onRangeChange($event)"
                placeholder="Du ... au ..."
            >
            </div>

            <p>Date sélectionnée: {{ selectedDate | date:'dd/MM/yyyy' }}</p>



            <div class="col-md-6 gy-6">
                <div class="form-floating">
                    <select class="form-select" id="floatingSelectClient">
                        <option selected="selected">Select client</option>
                        <option value="1">Client One</option>
                        <option value="2">Client Two</option>
                        <option value="3">Client Three</option>
                    </select>
                    <label for="floatingSelectClient">client</label>
                </div>
            </div>

            <div class="col-md-6 gy-6">
                <div class="form-floating">
                    <input class="form-control" id="floatingInputBudget" type="number" placeholder="Budget" />
                    <label for="floatingInputBudget">Budget</label>
                </div>
            </div>


            <!-- Frais d'agence -->
          <div class="col-md-6 gy-6">
            <app-currency-input
              id="floatingInputFees"
              label="Frais d'agence"
              placeholder="Frais"
              name="agencyFees"
            ></app-currency-input>
          </div>




            <div class="col-12 gy-6">
                <div class="form-floating form-floating-advance-select">
                    <label>Add tags</label>
                    <select class="form-select" id="organizerMultiple" data-choices="data-choices" multiple="multiple"
                        data-options='{"removeItemButton":true,"placeholder":true}'>
                        <option selected="selected">Stupidity</option>
                        <option>Jerry</option>
                        <option>Not_the_mouse</option>
                        <option>Rick</option>
                        <option>Biology</option>
                        <option>Neurology</option>
                        <option>Brainlessness</option>
                    </select>
                </div>
            </div>

            <div class="col-12 gy-6">
                <div class="row g-3 justify-content-end">
                    <div class="col-auto">
                        <button class="btn btn-phoenix-primary px-5">Annuler</button>
                    </div>
                    <div class="col-auto">
                        <button type="submit" class="btn btn-primary px-5 px-sm-15">Create Project</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>